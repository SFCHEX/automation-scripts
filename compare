import pandas as pd
import sys

def compare_excel_files(file1, file2):
    try:
        df1 = pd.read_excel(file1, engine='openpyxl')
        df2 = pd.read_excel(file2, engine='openpyxl')
    except Exception as e:
        print(f"Error reading files: {e}")
        return

    differences = (df1 != df2)
    rows_with_differences = differences.any(axis=1)

    if rows_with_differences.any():
        print("Differences found:")
        for index, row in df1[rows_with_differences].iterrows():
            for col in df1.columns:
                val1 = row[col]
                val2 = df2.at[index, col]
                if val1 != val2:
                    print(f"In row {index + 2}, header {col} for sheet 1 says '{val1}' while sheet 2 says '{val2}'.")
    else:
        print("No differences found.")

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: python excel_compare.py <file1.xlsx> <file2.xlsx>")
        sys.exit(1)

    file1 = sys.argv[1]
    file2 = sys.argv[2]

    compare_excel_files(file1, file2)
