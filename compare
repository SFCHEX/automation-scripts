import pandas as pd
import sys

def compare_excel_files(file1, file2):
    try:
        df1 = pd.read_excel(file1, engine='openpyxl')
        df2 = pd.read_excel(file2, engine='openpyxl')
    except Exception as e:
        print(f"Error reading files: {e}")
        return

    differences = df1.compare(df2)

    if not differences.empty:
        print("Differences found:")
        for index, row in differences.iterrows():
            for column, (val1, val2) in row.items():
                print(f"In row {index + 2}, column {column}, Sheet 1 has '{val1}' while Sheet 2 has '{val2}'.")
    else:
        print("No differences found.")

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: python excel_compare.py <file1.xlsx> <file2.xlsx>")
        sys.exit(1)

    file1 = sys.argv[1]
    file2 = sys.argv[2]

    compare_excel_files(file1, file2)
